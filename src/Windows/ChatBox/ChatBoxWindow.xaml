<Window x:Class="ScreenTranslation.ChatBoxWindow"         
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ScreenTranslation"
        mc:Ignorable="d"
        Title="Recent Texts" 
        Height="300" Width="400"
        Topmost="True"
        AllowsTransparency="True"
        Background="#80000000"
        WindowStyle="None"
        ResizeMode="CanResizeWithGrip"
        Icon="/media/AppIcon.ico">
    
    <WindowChrome.WindowChrome>
        <WindowChrome ResizeBorderThickness="8" CaptionHeight="0" GlassFrameThickness="0" UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>
    
    <Window.Resources>
        <!-- Style for button on title bar -->
        <Style x:Key="HeaderButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#CC2D4C70"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="2,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Margin}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF3E6999"/>
                                <Setter Property="Cursor" Value="Hand"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF2A4A6E"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Style for close button -->
        <Style x:Key="CloseButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#CCE63232"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FFFF4C4C"/>
                                <Setter Property="Cursor" Value="Hand"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FFC42B2B"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Style scroll bar -->
        <Style x:Key="CustomScrollBarThumbStyle" TargetType="{x:Type Thumb}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Rectangle Fill="#99FFFFFF" RadiusX="3" RadiusY="3"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="CustomScrollBarStyle" TargetType="{x:Type ScrollBar}">
            <Setter Property="Width" Value="8"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid>
                            <Rectangle Width="8" Fill="#33000000"/>
                            <Track x:Name="PART_Track" IsDirectionReversed="True">
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource CustomScrollBarThumbStyle}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid>
        <!-- Modern header/title bar with enhanced design -->
        <Border x:Name="headerBar" Height="42" VerticalAlignment="Top" Background="#E6202020"
                MouseLeftButtonDown="Header_MouseLeftButtonDown"
                Panel.ZIndex="1"
                CornerRadius="0,0,0,0"
                BorderThickness="0,0,0,1"
                BorderBrush="#33FFFFFF">
            <Border.Effect>
                <DropShadowEffect BlurRadius="2" ShadowDepth="1" Opacity="0.3" Color="#000000"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Left side - Title with icon -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="15,0,0,0">
                    <TextBlock Text="💬" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBlock Text="Recent Text" Foreground="White"
                               VerticalAlignment="Center" FontWeight="SemiBold" FontSize="16"/>
                </StackPanel>

                <!-- Center - Status indicator -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock x:Name="entryCountText" Text="0 entries" Foreground="#CCCCCC"
                               FontSize="12" VerticalAlignment="Center" FontStyle="Italic"/>
                </StackPanel>

                <!-- Right side - Control buttons -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,5,0">
                    <Button x:Name="optionsButton" Content="⚙" Width="32" Height="32"
                            Style="{StaticResource HeaderButtonStyle}"
                            Click="OptionsButton_Click"
                            ToolTip="Configure appearance settings"
                            FontSize="14"/>
                    <Button x:Name="modeButton" Content="🌐" Width="80" Height="32"
                            Style="{StaticResource HeaderButtonStyle}"
                            Click="ModeButton_Click"
                            ToolTip="Toggle between showing both languages or only the translate/source text"
                            FontSize="11" HorizontalContentAlignment="Center"/>
                    <Button x:Name="fontDecreaseButton" Content="🔍-" Width="32" Height="32"
                            Style="{StaticResource HeaderButtonStyle}"
                            Click="FontDecreaseButton_Click"
                            ToolTip="Decrease font size"/>
                    <Button x:Name="fontIncreaseButton" Content="🔍+" Width="32" Height="32"
                            Style="{StaticResource HeaderButtonStyle}"
                            Click="FontIncreaseButton_Click"
                            ToolTip="Increase font size"/>
                    <Button x:Name="clearButton" Content="🗑" Width="32" Height="32"
                            Style="{StaticResource HeaderButtonStyle}"
                            Click="ClearButton_Click"
                            ToolTip="Clear translation history"/>
                    <Button Content="✕" Width="32" Height="32"
                            Style="{StaticResource CloseButtonStyle}"
                            Click="CloseButton_Click"
                            ToolTip="Close window"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Enhanced content area with modern design -->
        <Border Margin="0,42,0,35" Background="#1A000000" CornerRadius="0">
            <Border.Effect>
                <DropShadowEffect BlurRadius="1" ShadowDepth="0" Opacity="0.1" Color="#FFFFFF"/>
            </Border.Effect>

            <ScrollViewer x:Name="chatScrollViewer"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled"
                          Background="Transparent"
                          Padding="0">
                <ScrollViewer.Resources>
                    <Style TargetType="{x:Type ScrollBar}" BasedOn="{StaticResource CustomScrollBarStyle}"/>
                </ScrollViewer.Resources>

                <!-- Content wrapper with improved padding -->
                <Border Background="Transparent" Padding="20,15,20,20" MinHeight="100">
                    <RichTextBox x:Name="chatHistoryText"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 IsReadOnly="True"
                                 VerticalScrollBarVisibility="Disabled"
                                 HorizontalScrollBarVisibility="Disabled"
                                 Padding="0"
                                 Margin="0"
                                 AcceptsReturn="True"
                                 IsDocumentEnabled="True"
                                 FontFamily="Segoe UI"
                                 FontSize="16"
                                 Foreground="White"
                                 Block.LineHeight="1.4"
                                 TextOptions.TextFormattingMode="Display"/>
                </Border>
            </ScrollViewer>
        </Border>
        
        <!-- Translation in progress indicator -->
        <Border x:Name="translationStatusPanel"
                Height="35"
                VerticalAlignment="Bottom"
                HorizontalAlignment="Stretch"
                Background="#DD202020"
                BorderThickness="0,1,0,0"
                BorderBrush="#444444"
                Margin="0,0,0,0"
                Visibility="Collapsed"
                Panel.ZIndex="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Service icon -->
                <TextBlock x:Name="serviceIcon"
                           Grid.Column="0"
                           Text="🔄"
                           FontSize="14"
                           VerticalAlignment="Center"
                           Margin="10,0,5,0"
                           Foreground="#FFD700"/>

                <!-- Status text and progress -->
                <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Center" Margin="0,2">
                    <TextBlock x:Name="translationStatusText"
                               Text="Translating with Google Translate..."
                               Foreground="White"
                               FontWeight="SemiBold"
                               FontSize="14"
                               VerticalAlignment="Center"/>
                    <ProgressBar x:Name="translationProgressBar"
                                 Height="3"
                                 MinWidth="100"
                                 MaxWidth="300"
                                 IsIndeterminate="True"
                                 Background="#33FFFFFF"
                                 Foreground="#FF4CAF50"
                                 Margin="0,2,0,0"
                                 HorizontalAlignment="Left"/>
                </StackPanel>

                <!-- Cancel button -->
                <Button x:Name="cancelTranslationButton"
                        Grid.Column="2"
                        Content="✕"
                        Width="20"
                        Height="20"
                        Margin="5,0,10,0"
                        Background="Transparent"
                        Foreground="#FFAAAAAA"
                        BorderThickness="0"
                        FontSize="10"
                        FontWeight="Bold"
                        ToolTip="Cancel translation"
                        Click="CancelTranslationButton_Click"
                        VerticalAlignment="Center">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                CornerRadius="2">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#22FF4444"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>
        
        <!-- Resize grip indicator - improved with Path instead of Rectangle -->
        <Path x:Name="resizeGrip" 
              Data="M 0,16 L 16,16 L 16,0 L 12,0 L 12,4 L 8,4 L 8,8 L 4,8 L 4,12 L 0,12 Z" 
              Fill="#99FFFFFF"
              HorizontalAlignment="Right" 
              VerticalAlignment="Bottom" 
              Width="16" 
              Height="16"
              Margin="0,0,0,0"/>
    </Grid>
</Window>